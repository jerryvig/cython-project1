<!doctype html>
<html>
<head>
	<title>FastCGI testing</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<style type="text/css">
		body {
			width: 100%;
		}

		#data-table {
			display: block;
			width: 60%;
			margin:0 auto;
		}

		th, td {
			padding: 6px;
		}

		.text-cell {
			text-align: left;
		}

		.numeric-cell {
			text-align: right;
		}

		#ticker-input {
			display: block;
			margin: 0 auto;
		}
	</style>
</head>
<body>
	<table id="data-table">
		<thead>
			<tr>
				<th>Ticker</th>
				<th>Title</th>
				<th>Change</th>
				<th>Record Count</th>
				<th>Self Correlation</th>
				<th>Sigma</th>
				<th>Sigma Change</th>
				<th>Top 10 Down</th>
				<th>Top 10 Up</th>
				<th>Avg Move Top 10 Down</th>
				<th>Avg Move Top 10 Up</th>
			</tr>
		</thead>
		<tbody id="data-table-body">
			<tr>
				<td id="ticker-cell" class="text-cell"></td>
				<td id="title-cell" class="text-cell"></td>
				<td id="change-cell" class="numeric-cell"></td>
				<td id="record-count-cell" class="numeric-cell"></td>
				<td id="self-correlation-cell" class="numeric-cell"></td>
				<td id="sigma-cell" class="numeric-cell"></td>
				<td id="sigma-change-cell" class="numeric-cell"></td>
				<td id="ten-down-cell" class="numeric-cell"></td>
				<td id="ten-up-cell" class="numeric-cell"></td>
				<td id="avg-mv-ten-down-cell" class="numeric-cell"></td>
				<td id="avg-mv-ten-up-cell" class="numeric-cell"></td>
			</tr>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="11">
					<input id="ticker-input" type="text" placeholder="Enter ticker symbol here"></input>
				</td>
			</tr>
		</tfoot>
	</table>
</body>
<script type="text/javascript">
	function addDataRow(ticker, data) {
		var template = `<tr> \
				<td id="ticker-cell" class="text-cell">${data.resp_ticker}</td>\
				<td id="title-cell" class="text-cell">${data.title}</td>\
				<td id="change-cell" class="numeric-cell">${data.change}</td>\
				<td id="record-count-cell" class="numeric-cell">${data.record_count}</td>\
				<td id="self-correlation-cell" class="numeric-cell">${data.self_correlation}</td>\
				<td id="sigma-cell" class="numeric-cell">${data.sigma}</td>\
				<td id="sigma-change-cell" class="numeric-cell">${data.sigma_change}</td>\
				<td id="ten-down-cell" class="numeric-cell">${data.sign_diff_pct_10_down}</td>\
				<td id="ten-up-cell" class="numeric-cell">${data.sign_diff_pct_10_up}</td>\
				<td id="avg-mv-ten-down-cell" class="numeric-cell">${data.avg_move_10_down}</td>\
				<td id="avg-mv-ten-up-cell" class="numeric-cell">${data.avg_move_10_up}</td>\
			</tr>`;
		$('#data-table-body').append( template );
	}

	$('#ticker-input').change(function(evt) {
		var ticker = $('#ticker-input').val();
		var url = `/compute_statistics/${ticker}`;

		$.get(url, function(data) {
			addDataRow(ticker, data);

		/*	$('#ticker-cell')
				.empty()
				.append( ticker.toUpperCase() );
			$('#title-cell')
				.empty()
				.append( data.title );
			$('#change-cell')
				.empty()
				.append( data.change );
			$('#record-count-cell')
				.empty()
				.append( data.record_count );
			$('#self-correlation-cell')
				.empty()
				.append( data.self_correlation );
			$('#sigma-cell')
				.empty()
				.append( data.sigma );
			$('#sigma-change-cell')
				.empty()
				.append( data.sigma_change );
			$('#ten-down-cell')
				.empty()
				.append( data.sign_diff_pct_10_down );
			$('#ten-up-cell')
				.empty()
				.append( data.sign_diff_pct_10_up );
			$('#avg-mv-ten-down-cell')
				.empty()
				.append( data.avg_move_10_down );
			$('#avg-mv-ten-up-cell')
				.empty()
				.append( data.avg_move_10_up );
			*/
			$('#ticker-input').val(''); 
		});
	});
</script>
</html>